<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bettem.modules.tourism.dao.TourismProductInfoDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.bettem.modules.tourism.entity.TourismProductInfoEntity" id="BaseMap">
        <result property="productName" column="product_name"/>
        <result property="productGuidePicUrl" column="product_guide_pic_url"/>
        <result property="lineType" column="line_type"/>
        <result property="startingCity" column="starting_city"/>
        <result property="tripDays" column="trip_days"/>
        <result property="tripNightNum" column="trip_night_num"/>
        <result property="startDate" column="start_date"/>
        <result property="endDate" column="end_date"/>
        <result property="adultPrice" column="adult_price"/>
        <result property="childrenPrice" column="children_price"/>
        <result property="singleRoomPrice" column="single_room_price"/>
        <result property="productCharacteristic" column="product_characteristic"/>
        <result property="travelInfo" column="travel_info"/>
        <result property="costInclusion" column="cost_inclusion"/>
        <result property="costExcluded" column="cost_excluded"/>
        <result property="reservationNotes" column="reservation_notes"/>
        <result property="returnRules" column="return_rules"/>
        <result property="contactNumber" column="contact_number"/>
        <result property="supplierId" column="supplier_id"/>
        <result property="supplierName" column="supplier_name"/>
        <result property="state" column="state"/>
    </resultMap>
    <sql id="baseSql">
        id,
        product_name,
        product_guide_pic_url,
        line_type,
        starting_city,
        trip_days,
        trip_night_num,
        start_date,
        end_date,
        adult_price,
        children_price,
        single_room_price,
        product_characteristic,
        travel_info,
        cost_inclusion,
        cost_excluded,
        reservation_notes,
        return_rules,
        contact_number,
        supplier_id,
        supplier_name,
        create_user_id,
        create_date,
        modify_user_id,
        modify_date,
        state
    </sql>
    <select id="selectProductInfoVOById"
            resultType="com.bettem.modules.tourism.entity.VO.TourismProductInfoVO">
         select
           <include refid="baseSql"/>
         from tourism_product_info
         <where>
             id = #{id,jdbcType=VARCHAR}
         </where>
    </select>
    <select id="selectProductListByParams" resultType="Map">
        select
           id as "id",
           product_name as "productName",
           product_guide_pic_url  as "productGuidePicUrl",
           adult_price as "adultPrice"
        from tourism_product_info
        <where>
            <!--  没有删除的并且为发布的 -->
            delete_state = '0' and state = '1'
            <if test="productName !=null and productName != ''">
                and product_name  like CONCAT(CONCAT('%', #{productName,jdbcType=VARCHAR}),'%')
            </if>
            <if test="lineType !=null and lineType !=''">
                and line_type = #{lineType,jdbcType=VARCHAR}
            </if>
            <if test="startingCity !=null and startingCity !=''">
                and starting_city = #{startingCity,jdbcType=VARCHAR}
            </if>
            <if test="startAdultPrice !=null and startAdultPrice !=''">
                and adult_price &gt;= #{startAdultPrice,jdbcType=DOUBLE}
            </if>
            <if test="endAdultPrice !=null and endAdultPrice !=''">
                and adult_price &lt;= #{endAdultPrice,jdbcType=DOUBLE}
            </if>
            order by create_date desc,state
        </where>
    </select>


</mapper>